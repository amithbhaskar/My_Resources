# DataStage Commands

## Trim Functions
Trim(Link.Col)
Trim(convert(char(10):char(13),'',EREPLACE(Link.Col,'|','')))
 
## Loop with delim '||'
Loop while                          : @ITERATION+ Number +1 <= DCount(Link.Col,'||')
Loop variable     : Field(Link.Col,'||', @ITERATION+ Number) - lp_var_name
 
## Replace Commands - EREPLACE(expression, string, replacement, occurrence)--occurrence(how many occurence to replace)
                REPLACE '|' WITH ''                                                                           : Ereplace(Trim(Link.Col),'|','')
                Convert Syntax                                                                                                   : convert(characters_to_replace, substitute_chars, Link.Col)
                Replacing new line(LF) and CR with space : convert(char(10):char(13),'',Trim(Link.Col,'|','A'))
                Replacing CR, LF and '|' with space            : convert(char(10):char(13),'',EREPLACE(Link.Col,'|',''))
               
## Null Handling Functions
                Replaces nulls with zero : NullToZero(Link.Col)
                IsNull,IsNotNull,NullToEmpty,NullToZero,NullToValue,setnull()
 
## Field Picker Function - Field(%Link.Col%,%delimiter%,%occurrence%,[%number%])
                Field(Link.Col,' ',1)
                Field(Link.Col,'||',1)='3'
                Field(Link.Col,'/',7)
 
## Date from String Conversion: DS default is yyyy-mm-dd hh:mm:ss
                2018-12-03 to Default                    : StringToDate(Link.Col,"%yyyy-%mm-%dd")
                03 12 2018 to Default                     : StringToDate(Link.Col,"%dd %mmm %yyyy")
                3-Dec-18 to Default                         : StringToDate(Link.Col,"%d-%mmm-%2000yy")
                09/01/2017 to Default                   : StringToDate(Link.Col,"%dd/%mm/%yyyy")
                Excel Seconds to Default               : TimestampToDate(TimestampFromSecondsSince2((Link.Col-25569)*86400,"1970-01-01 00:00:00"))
                FileDate format reader in Sequence Job : Change(Oconv(@DATE-1,"DYMD[4,2,2]"),"/","")
               
## Timestamp from String Conversion
                Timestamp to Date                                                          : TimestampToDate(Link.Col)
                03 Dec 2018 12:53 to Default      : StringToTimestamp(Link.Col,"%dd %mmm %yyyy %(h,s):%(n,s)")
                2018-12-31 12:25:53 to Default  : StringToTimestamp(Link.Col,"%yyyy-%mm-%dd %hh:%nn:%ss")
                Dec-03-2018 12:25 to Default     : StringToTimestamp(Link.Col,"%mmm-%dd-%yyyy %hh:%nn")
                29-12-18 1:13 to Default                               : StringToTimestamp(Link,Col,"%dd-%mm-%2000yy %h:%nn")
                20090707123100 to Default                        : StringToTimestamp(Link.Col,"%yyyy%mm%dd%hh%nn%ss")
                               
## Time from String Conversions
                StringToTime(Link,Col,"%hh:%nn") --HH:MM
                StringToTime(Link,Col,"%h:%nn")
                StringToTime(Link,Col,"%(h,s):%(n,s)")
                If (Link,Col='24:00:00') Then StringToTime('00:00:00',"%h:%nn:%ss")  Else StringToTime(Link,Col,"%h:%nn")
               
## Decimal from String
                StringToDecimal(Trim(Link,Col))
 
               
## Dcount - Count number of delimited fields in a string.
                DCount(Link.Col,%delimiter%)
                DCount(“I_am_Data_stage_Developer”,”_”) = 5
 
## Case Conversions
                DownCase(string)
                UpCase(string)
               
## Len - Length of string
                Len("abcd")=4 
               
## Environment Variables
                $TMP_DIR - Temporary directory path : /data/TEST
                $APT_DEFAULT_TRANSPORT_BLOCK_SIZE - Specify the default block size in bytes for transferring data between players. The valid value range for this variable is 8192 to 268435456 bytes. : 1048576
                $APT_MAX_DELIMITED_READ_SIZE - This sets the initial size of the buffer to be used by the importer for an incoming data stream containing delimited records. : 5000000000000
 
## Own End of Line replaced with $
                Loop While: @ITERATION+ Number +1 <= DCount(Lnk_Tfm.Header,'||')
                Derivation: Field(Lnk_Tfm.Header,'||', @ITERATION+ Number)
                                                                Trim(Field(Lnk_Tfm.Column,'||', @ITERATION+ Number),'$','A')
 
To find line breaks in Excel : Use Ctrl+J in Find and replace
Refer: https://www.ablebits.com/office-addins-blog/2013/12/03/remove-carriage-returns-excel/
 
Transaction Count [Default - 2000] in DB connector stage
Do not make 0, as table will be locked. It specifies after how many records, commit needs to happen.
 
Surrogate key generator state file: is the source for surrogate key generator stage, the state file (essentially a flat file in the file system) persists data that contains the next value and properties for creation of keys between job runs utilising this source.
To create a new state file, start by creating a new parallel job and add a surrogate key generator stage, do not add any input or output links. On the Properties tab, define the Key Source properties:
                a. Set the Key Source Action property to Create.
                b. Source Name, browse to or type location and file name for this new state file..
                c. Select the source type as Flat File.
                d. Leave View State File as False
 
Update happens first and then inserts.
http://data-engineer.in/2014/04/27/slowing-changing-dimension-using-scd-stage-in-datastage/
 
  
 
 
 
Interview prep Links:
http://www.softwaretestinghelp.com/datastage-interview-questions/
 
dimension madelling ER modelling
star and snow flake
facts and types
dim and types
surrogate keys
 
 
 
Unix
cut
sed
awk
grep
 
 
 
SQL
Joins and types
group by
heirachy
selfjoin
types index and their importace
 
Datastage
stage valiables
how tranformer works
loop valiables
configuration files
all stages
diff join lookup and merge
join types
sparse lookup
remove duplicates using stage valiables
cumilative sum
max min salary
group by dept salary
 
362
 
 
(@INROWNUM-1)*NUMPARTITIONS+@PARTITIONNUM+1
 
To get Cumulative Sum
Ex:
                a 1
                a 2
                a 3
                b 1
                b 2
                c 1
Ans:
sv1=sv2
sv2=in_lnk
sv3= if sv1=sv2 then sv3+1 else 1
 
                                sv1=sv2
                                sv2=in_lnk
                                sv3=if sv1=sv2 then csum+sv2 else sv2
                                csum=if sv1<>sv2 then 0 else csum+sv2
 
                a 1
sv1=null
sv2=1
sv3=1
csum=1
 
                a 1
                a 2
sv1=1
sv2=2
sv3=3
csum=3
 
                a 1
                a 2
                a 3
sv1=2
sv2=3
sv3=6
csum=6
 
                a 1
                a 2
                a 3
                b 1
sv1=3
sv2=1
sv3=1
csum=0
 
                a 1
                a 2
                a 3
                b 1
                b 2
sv1=1
sv2=2
sv3=2
 
 
http://www.databaseetl.com/user-variable-stage-in-datastage/
 
## Types of Parallel Processing:
Symmetric Processing (SMP)
                All the CPUs share the same memory.
                SMP systems create a bottleneck problem in which all CPUs attempt to access same memory at once.
 
Massively Parallel Processing (MPP)
                MPP architecture consists of multiple servers with each node/server is autonomous to process and store up data.
                High volumes of data in data warehouse systems are made into smaller and more manageable blocks, which are then distributed to multiple processors.
                In MPP systems, data is distributed/processed across many servers (nodes) in CPUs, each of which has its own memory and disk thus sharing the load.
                Although there is no disk-level sharing, all communication happen through network interconnect.
                MPPs are high in cost and complexity,
               
https://career.guru99.com/top-50-datastage-interview-questions/
https://mindmajix.com/datastage-interview-questions-answers
http://datastage4you.blogspot.com/2014/06/aptconfigfile-configuration-file.html?m=1
http://www.geekinterview.com/question_details/77921
http://mydatastage-notes.blogspot.com/2013/04/configuration-file.html?m=1

